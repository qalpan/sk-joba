<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SK-Joba | Unified Map & Search</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css" />
    <style>
        :root { --primary: #007bff; --success: #28a745; --warning: #ffc107; --danger: #dc3545; --dark: #343a40; }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background: #f4f7f6; color: #333; }
        
        .header-box { position: sticky; top: 0; z-index: 1000; text-align: center; }
        .search-input { width: 90%; padding: 12px 20px; border-radius: 25px; border: 2px solid var(--primary); outline: none; font-size: 16px; }
        
        .style-switcher { display: flex; justify-content: center; gap: 10px; margin-top: 5px; }
        .style-btn { width: auto; padding: 6px 15px; font-size: 12px; border-radius: 15px; border: 1px solid #ddd; background: #999; cursor: pointer; transition: 0.3s; }
        .style-btn.active { background: var(--primary); color: white; border-color: var(--primary); }

        #map { height: 45vh; width: 100%; border-bottom: 3px solid var(--primary); }

        #visible-list-container { background: white; margin: 10px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); overflow: hidden; }
        .list-header { padding: 12px; background: #f8f9fa; border-bottom: 1px solid #eee; font-weight: bold; color: var(--dark); display: flex; justify-content: space-between; }
        #dynamic-list-content { max-height: 250px; overflow-y: auto; }
        .list-item { padding: 12px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .list-info b { display: block; color: var(--primary); font-size: 15px; }
        .list-info span { font-size: 13px; color: #666; }
        .list-call { background: var(--success); color: white; padding: 8px 15px; border-radius: 20px; text-decoration: none; font-size: 12px; font-weight: bold; }

        .container { padding: 15px; display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; }
        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); border-top: 5px solid var(--primary); }
        input, textarea, button { width: 100%; padding: 8px; border-radius: 8px; border: 1px solid #ddd; font-size: 14px; box-sizing: border-box; }
        button { background: var(--primary); color: white; border: none; font-weight: bold; cursor: pointer; }
        .vip-btn {margin: 8px 0px 0px 0px;  }
        .payment-info { background: #fff3cd; padding: 10px; border-radius: 8px; font-size: 12px; color: #856404; margin-bottom: 10px; }

        .marker-label { background: white; border: 1px solid var(--primary); border-radius: 4px; padding: 2px 6px; font-size: 11px; font-weight: bold; white-space: nowrap; box-shadow: 2px 2px 5px rgba(0,0,0,0.1); pointer-events: none; }

        #admin-modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:white; z-index:10001; padding:20px; overflow-y:auto; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 12px; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }

        .leaflet-popup-content-wrapper {border-radius: 12px; padding: 5px; box-shadow: 0 5px 15px rgba(0,0,0,0.2);}
        .leaflet-popup-content { margin: 10px; line-height: 1.4;} 
    </style>
</head>
<body>

<div class="header-box">
    <input type="text" id="searchInput" class="search-input" placeholder="–ù–µ —ñ–∑–¥–µ–ø –∂“Ø—Ä—Å—ñ–∑? (–º–∞–º–∞–Ω–¥—ã“õ, —Ç–∞—É–∞—Ä...)" oninput="filterMarkers(); updateVisibleList();">
    <div class="style-switcher">
        <button id="btn-color" class="style-btn active" onclick="changeMapStyle('color')">üåà –¢“Ø—Å—Ç—ñ –∫–∞—Ä—Ç–∞</button>
        <button id="btn-mono" class="style-btn" onclick="changeMapStyle('mono')">üîò –ê“õ-“õ–∞—Ä–∞</button>
    </div>
</div>

<div id="map"></div>

<div id="visible-list-container">
    <div class="list-header">
        <span>üìç –û—Å—ã –º–∞“£–∞–π–¥–∞“ì—ã –∞“õ–ø–∞—Ä–∞—Ç—Ç–∞—Ä</span>
        <span id="item-count">0</span>
    </div>
    <div id="dynamic-list-content">
        <p style="padding: 15px; color: #999;">–ö–∞—Ä—Ç–∞–Ω—ã –∂—ã–ª–∂—ã—Ç—ã“£—ã–∑ –Ω–µ–º–µ—Å–µ —ñ–∑–¥–µ“£—ñ–∑...</p>
    </div>
</div>

<div class="container">
    <div class="card" style="border-top-color: var(--primary);">
        <h4>üë∑ “ö—ã–∑–º–µ—Ç –∂–∞—Ä–∏—è–ª–∞—É</h4>
        <input id="w_name" placeholder="–ê—Ç—ã“£—ã–∑">
        <input id="w_job" placeholder="–ú–∞–º–∞–Ω–¥—ã“õ (–º—ã—Å–∞–ª—ã: –°–∞–Ω—Ç–µ—Ö–Ω–∏–∫)">
        <input id="w_phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω –Ω”©–º—ñ—Ä—ñ">
        <div class="payment-info">üíé VIP: 24 —Å–∞“ì–∞—Ç –±–æ–π—ã –∫–∞—Ä—Ç–∞–¥–∞ —Ç“±—Ä–∞“õ—Ç—ã –∫”©—Ä—ñ–Ω—É.</div>
        <button onclick="saveItem('worker')">–¢–µ–≥—ñ–Ω –∂–∞—Ä–∏—è–ª–∞—É</button>
        <button class="vip-btn" onclick="initVIP('worker')">üíé VIP –∂–∞—Ä–∏—è–ª–∞—É</button>
    </div>

    <div class="card" style="border-top-color: var(--warning);">
        <h4>üì¶ –¢–∞—É–∞—Ä —Å–∞—Ç—É</h4>
        <input id="g_name" placeholder="–°–∞—Ç—É—à—ã –∞—Ç—ã">
        <input id="g_prod" placeholder="–¢–∞—É–∞—Ä –∞—Ç—ã (–º—ã—Å–∞–ª—ã: –°“Ø—Ç)">
        <input id="g_price" placeholder="–ë–∞“ì–∞—Å—ã">
        <input id="g_phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω">
        <div class="payment-info">üíé VIP: –•–∞–±–∞—Ä–ª–∞–º–∞“£—ã–∑ ”©—à–ø–µ–π–¥—ñ.</div>
        <button onclick="saveItem('good')" style="background:var(--warning);">–¢–µ–≥—ñ–Ω –∂–∞—Ä–∏—è–ª–∞—É</button>
        <button class="vip-btn" onclick="initVIP('good')" style="background:var(--warning)">üíé VIP –∂–∞—Ä–∏—è–ª–∞—É</button>
    </div>

<div class="card" style="border-top-color: var(--success);">
    <h4>üìã –¢–∞–ø—Å—ã—Ä—ã—Å –±–µ—Ä—É</h4>
    <input id="c_name" placeholder="–ê—Ç—ã“£—ã–∑">
    <textarea id="c_desc" placeholder="–ö”©–º–µ–∫ –Ω–µ–º–µ—Å–µ —Ç–∞–ø—Å—ã—Ä—ã—Å —Å–∏–ø–∞—Ç—Ç–∞–º–∞—Å—ã"></textarea>
    <input id="c_phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω">
    <div class="payment-info">üíé VIP: –¢–∞–ø—Å—ã—Ä—ã—Å—ã“£—ã–∑ —Ç—ñ–∑—ñ–º–Ω—ñ“£ –µ“£ –±–∞—Å—ã–Ω–¥–∞ –∂”ô–Ω–µ –µ—Ä–µ–∫—à–µ —Ç“Ø—Å–ø–µ–Ω –∫”©—Ä—ñ–Ω–µ–¥—ñ.</div>
    <button style="background: var(--success);" onclick="saveItem('order')">–¢–µ–≥—ñ–Ω –∂–∞—Ä–∏—è–ª–∞—É</button>
    <button class="vip-btn" style="background: #28a745; color: white; border: 2px solid #1e7e34;" onclick="initVIP('order')">üíé VIP —Ç–∞–ø—Å—ã—Ä—ã—Å</button>
</div>
</div>

<div id="admin-modal">
    <div style="display:flex; justify-content: space-between;">
        <h2>–ë–∞—Å“õ–∞—Ä—É –ø–∞–Ω–µ–ª—ñ (–ê–¥–º–∏–Ω)</h2>
        <button onclick="location.hash=''" style="width:80px; background:var(--danger);">–ñ–∞–±—É</button>
    </div>
    <div id="admin-content"></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js"></script>
<script src="https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js"></script>

<script>
    const API = "https://sk-joba.onrender.com";
    const myToken = localStorage.getItem('token') || Math.random().toString(36).substr(2);
    localStorage.setItem('token', myToken);

    const map = L.map('map').setView([43.2389, 76.8897], 13);
    const layers = {
        color: L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'),
        mono: L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png')
    };
    layers.color.addTo(map);

    // Spiderfy —ç—Ñ—Ñ–µ–∫—Ç—ñ—Å—ñ–Ω “õ–æ—Å–∞–º—ã–∑
    const markersGroup = L.markerClusterGroup({
        spiderfyOnMaxZoom: true,
        showCoverageOnHover: false,
        zoomToBoundsOnClick: true
    });
    map.addLayer(markersGroup);

    let rawData = [];
    let adminData = null;
    let currentStyle = 'color';

    function changeMapStyle(style) {
        map.removeLayer(layers[currentStyle]);
        layers[style].addTo(map);
        currentStyle = style;
        document.querySelectorAll('.style-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('btn-' + style).classList.add('active');
    }

    map.on('moveend', updateVisibleList);

    function sendPing() {
        fetch(API + '/user-ping', { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ token: myToken }) });
    }
    setInterval(sendPing, 30000);
    sendPing();

function loadMarkers() {
    fetch(API + '/get-all')
        .then(r => r.json())
        .then(data => {
            adminData = data.admin_all;
            // –î–µ—Ä–µ–∫—Ç–µ—Ä–¥—ñ –±—ñ—Ä—ñ–∫—Ç—ñ—Ä—É –∂”ô–Ω–µ —Å“±—Ä—ã–ø—Ç–∞—É (VIP-—Ç–µ—Ä –∞–ª–¥—ã–Ω–¥–∞ —Ç“±—Ä–∞–¥—ã)
            const newData = [
                ...data.workers.map(i => ({...i, type: 'worker', info: i.job})),
                ...data.goods.map(i => ({...i, type: 'good', info: i.product_name})),
                ...data.orders.map(i => ({...i, type: 'order', info: i.description}))
            ].sort((a, b) => (b.is_active === a.is_active) ? 0 : b.is_active ? 1 : -1);

            if (JSON.stringify(rawData) !== JSON.stringify(newData)) {
                rawData = newData;
                filterMarkers();
                updateVisibleList();
            }
            
            if(document.getElementById('admin-modal').style.display === 'block') renderAdmin();
        })
        .catch(err => console.error("–ñ–∞“£–∞—Ä—Ç—É “õ–∞—Ç–µ—Å—ñ:", err));
}

    function filterMarkers() {
        const term = document.getElementById('searchInput').value.toLowerCase();
        const isMobile = window.innerWidth < 768;
        markersGroup.clearLayers();

        rawData.forEach(i => {
            if (i.info.toLowerCase().includes(term)) {
                const color = i.type === 'worker' ? '#007bff' : (i.type === 'good' ? '#ffc107' : '#28a745');
                const m = L.marker([i.lat, i.lon], {
                    icon: L.divIcon({ html: `<div style="background:${color};width:14px;height:14px;border-radius:50%;border:2px solid #fff;box-shadow:0 0 5px rgba(0,0,0,0.3)"></div>`, className: '' })
                });

                let delBtn = "";
                if (i.device_token === myToken) {
                    delBtn = `<br><button onclick="deleteItem(${i.id}, '${i.type}')" style="background:var(--danger); color:white; padding:8px; margin-top:10px; border:none; border-radius:5px; font-size:12px; width:100%; cursor:pointer;">”®–∑ —Ö–∞–±–∞—Ä–ª–∞–º–∞–º–¥—ã ”©—à—ñ—Ä—É ‚ùå</button>`;
                }

                m.bindPopup(`
                    <div style="min-width:160px;">
                        <b>${i.type.toUpperCase()}</b><br>
                        ${i.info}<br>
                        <a href="tel:${i.phone}" style="display:block; background:var(--success); color:white; text-align:center; padding:8px; border-radius:5px; text-decoration:none; margin-top:5px;">üìû “ö–æ“£—ã—Ä–∞—É</a>
                        ${delBtn}
                    </div>
                `, { autoPan: true, offset: [0, -5] });
                
                m.bindTooltip(i.info.substring(0,20), { 
                    permanent: !isMobile, 
                    direction: 'bottom', 
                    offset: [0, 10], 
                    className: 'marker-label' 
                });

                markersGroup.addLayer(m);
            }
        });
    }

function updateVisibleList() {
    const bounds = map.getBounds();
    const term = document.getElementById('searchInput').value.toLowerCase();
    let html = '';
    let count = 0;

    rawData.forEach(i => {
        const loc = L.latLng(i.lat, i.lon);
        if(bounds.contains(loc) && i.info.toLowerCase().includes(term)) {
            count++;
            const color = i.type === 'worker' ? '#007bff' : (i.type === 'good' ? '#ffc107' : '#28a745');
            
            // --- –û–°–´ –ñ–ï–†–ì–ï –ñ–ê“¢–ê –ö–û–î–¢–´ “ö–û–ô–î–´“ö ---
            // –ï–≥–µ—Ä i.is_active true –±–æ–ª—Å–∞, –æ–ª VIP –±–æ–ª—ã–ø —Å–∞–Ω–∞–ª–∞–¥—ã
            const isVIP = i.is_active === true; 
            const vipClass = isVIP ? 'style="border: 2px solid #28a745; background: #fafffa; border-radius:10px; margin-bottom:5px;"' : '';
            
            let userAction = `<a href="tel:${i.phone}" class="list-call">üìû “ö–æ“£—ã—Ä–∞—É</a>`;
            if (i.device_token === myToken) {
                userAction = `<button onclick="deleteItem(${i.id}, '${i.type}')" style="background:var(--danger); color:white; width:auto; padding:5px 10px; font-size:11px; margin:0; border:none; border-radius:15px; cursor:pointer;">”®—à—ñ—Ä—É</button>`;
            }

            html += `
                <div class="list-item" ${vipClass}>
                    <div class="list-info">
                        <b style="color:${color}">${isVIP ? '‚≠ê VIP: ' : ''}${i.info}</b>
                        <span>${i.name || i.seller_name || i.client_name || '–ü–∞–π–¥–∞–ª–∞–Ω—É—à—ã'} ‚Ä¢ ${i.type}</span>
                    </div>
                    ${userAction}
                </div>
            `;
            // -----------------------------------
        }
    });
    document.getElementById('item-count').innerText = count;
    document.getElementById('dynamic-list-content').innerHTML = count > 0 ? html : '<p style="padding:15px; color:#999;">–ë“±–ª –∞—É–º–∞“õ—Ç–∞ –∞“õ–ø–∞—Ä–∞—Ç –∂–æ“õ...</p>';
}

    // –ñ–ê–õ–ü–´ ”®–®–Ü–†–£ –§–£–ù–ö–¶–ò–Ø–°–´ (“ö–æ—Å—ã–ª–¥—ã)
    function deleteItem(id, type, isAdmin = false) {
        if(!confirm("–ù–∞“õ—Ç—ã ”©—à—ñ—Ä–µ—Å—ñ–∑ –±–µ?")) return;
        const tokenToSend = isAdmin ? 'admin777' : myToken;

        fetch(API + '/delete-item', { 
            method: 'POST', 
            headers: {'Content-Type': 'application/json'}, 
            body: JSON.stringify({id: parseInt(id), type, token: tokenToSend}) 
        })
        .then(r => r.json())
        .then(data => {
            if(data.success) {
                alert("”®—à—ñ—Ä—ñ–ª–¥—ñ!");
                loadMarkers();
            } else {
                alert("“ö–∞—Ç–µ: ”®—à—ñ—Ä—É–≥–µ —Ä“±“õ—Å–∞—Ç –∂–æ“õ.");
            }
        });
    }

// index.html —ñ—à—ñ–Ω–¥–µ–≥—ñ —Ñ—É–Ω–∫—Ü–∏—è–ª–∞—Ä

function saveItem(type, isVIP = false) {
    let d = {}, path = '';
    if(type==='worker'){ path='/save-worker'; d={name:v('w_name'), job:v('w_job'), phone:v('w_phone')}; }
    if(type==='good'){ path='/save-goods'; d={name:v('g_name'), product:v('g_prod'), price:v('g_price'), phone:v('g_phone')}; }
    if(type==='order'){ path='/save-order'; d={name:v('c_name'), description:v('c_desc'), phone:v('c_phone')}; }

    if(!d.phone) return alert("–¢–µ–ª–µ—Ñ–æ–Ω –Ω”©–º—ñ—Ä—ñ–Ω –∂–∞–∑—ã“£—ã–∑!");

    navigator.geolocation.getCurrentPosition(p => {
        d.lat = p.coords.latitude; 
        d.lon = p.coords.longitude; 
        d.device_token = myToken;
        d.is_vip = isVIP; // VIP –µ–∫–µ–Ω—ñ–Ω –±–µ–ª–≥—ñ–ª–µ–π–º—ñ–∑

        fetch(API + path, { 
            method: 'POST', 
            headers: {'Content-Type': 'application/json'}, 
            body: JSON.stringify(d) 
        })
        .then(() => { 
            if(isVIP) {
                alert("”®—Ç—ñ–Ω—ñ–º –∂—ñ–±–µ—Ä—ñ–ª–¥—ñ! –¢”©–ª–µ–º —Ä–∞—Å—Ç–∞–ª“ì–∞–Ω —Å–æ“£ (5-10 –º–∏–Ω) —Ö–∞–±–∞—Ä–ª–∞–º–∞“£—ã–∑ –∫–∞—Ä—Ç–∞–¥–∞ –ø–∞–π–¥–∞ –±–æ–ª–∞–¥—ã.");
            } else {
                alert("–°”ô—Ç—Ç—ñ –∂–∞—Ä–∏—è–ª–∞–Ω–¥—ã! (–ï—Å–∫–µ—Ä—Ç—É: –¢–µ–≥—ñ–Ω —Ö–∞–±–∞—Ä–ª–∞–º–∞ —Ç–µ–∫ —Å—ñ–∑ –æ–Ω–ª–∞–π–Ω –±–æ–ª“ì–∞–Ω–¥–∞ –∫”©—Ä—ñ–Ω–µ–¥—ñ)");
            }
            loadMarkers(); 
        });
    }, () => alert("GPS —Ä“±“õ—Å–∞—Ç—ã–Ω –±–µ—Ä—ñ“£—ñ–∑!"));
}

function initVIP(type) {
    const adminEmail = "sk-joba@outlook.com"; // –û—Å—ã –∂–µ—Ä–≥–µ ”©–∑ email-—ñ“£—ñ–∑–¥—ñ –∂–∞–∑—ã“£—ã–∑
    const confirmPayment = confirm("VIP –°–¢–ê–¢–£–° (490‚Ç∏).\nKaspi: +77017398309 (–°.–ö.)\n\n–¢”©–ª–µ–º –∂–∞—Å–∞—Å–∞“£—ã–∑ '–û–ö' –±–∞—Å—ã“£—ã–∑. –•–∞–±–∞—Ä–ª–∞–º–∞“£—ã–∑ —Å–∞“õ—Ç–∞–ª—ã–ø, –ø–æ—à—Ç–∞ –∞—Ä“õ—ã–ª—ã —Å–∫—Ä–∏–Ω—à–æ—Ç –∂—ñ–±–µ—Ä—É—ñ“£—ñ–∑ –∫–µ—Ä–µ–∫.");
    
    if(confirmPayment) {
        saveItem(type, true);
        
        // –ü–æ—à—Ç–∞“ì–∞ —Ö–∞—Ç –∂–∞–∑—É —Ç–µ—Ä–µ–∑–µ—Å—ñ–Ω –∞—à—É
        const subject = encodeURIComponent(`VIP –¢”©–ª–µ–º —Ä–∞—Å—Ç–∞—É: ${type}`);
        const body = encodeURIComponent(`–°”ô–ª–µ–º–µ—Ç—Å—ñ–∑ –±–µ! \n\n–ú–µ–Ω ${type} –±–æ–π—ã–Ω—à–∞ VIP —Ç”©–ª–µ–º –∂–∞—Å–∞–¥—ã–º. –¢”©–ª–µ–º —Å–∫—Ä–∏–Ω—à–æ—Ç—ã–Ω –æ—Å—ã —Ö–∞—Ç“õ–∞ —Ç—ñ—Ä–∫–µ–ø –∂—ñ–±–µ—Ä—ñ–ø –æ—Ç—ã—Ä–º—ã–Ω. –¢–µ–∫—Å–µ—Ä—ñ–ø, –∫–∞—Ä—Ç–∞“ì–∞ —à—ã“ì–∞—Ä—É—ã“£—ã–∑–¥—ã —Å“±—Ä–∞–π–º—ã–Ω.`);
        
        window.location.href = `mailto:${adminEmail}?subject=${subject}&body=${body}`;
    }
}

    function renderAdmin() {
        if(!adminData) return;
        let h = `<table><tr><th>–¢“Ø—Ä—ñ</th><th>–ò–Ω—Ñ–æ</th><th>–°—Ç–∞—Ç—É—Å</th><th>–ë–∞—Å“õ–∞—Ä—É</th></tr>`;
        const list = [
            ...adminData.workers.map(x=>({...x, t:'worker', msg: x.job})),
            ...adminData.goods.map(x=>({...x, t:'good', msg: x.product_name})),
            ...adminData.orders.map(x=>({...x, t:'order', msg: x.description}))
        ];
        list.forEach(i => {
            const status = i.is_active ? "<b style='color:green'>VIP</b>" : "–¢–µ–≥—ñ–Ω";
            const btn = `<button onclick="toggleActive(${i.id},'${i.t}', ${!i.is_active})" style="padding:4px; font-size:10px; background:var(--primary);">${i.is_active ? 'VIP ”®—à—ñ—Ä—É' : 'VIP “ö–æ—Å—É'}</button>`;
            const del = `<button onclick="deleteAdmin(${i.id},'${i.t}')" style="background:var(--danger); padding:4px; font-size:10px;">–ñ–æ—é</button>`;
            h += `<tr><td>${i.t}</td><td>${i.msg}</td><td>${status}</td><td>${btn} ${del}</td></tr>`;
        });
        document.getElementById('admin-content').innerHTML = h + "</table>";
    }

    function toggleActive(id, type, active) {
        fetch(API + '/admin/toggle-active', { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({id, type, active}) }).then(() => loadMarkers());
    }

    function deleteAdmin(id, type) {
        deleteItem(id, type, true);
    }

    function v(id){ return document.getElementById(id).value.trim(); }

    window.onhashchange = () => {
        if(location.hash === "#admin777") {
            const pass = prompt("“ö“±–ø–∏—è —Å”©–∑:");
            if(pass === "admin777") { document.getElementById('admin-modal').style.display='block'; renderAdmin(); }
            else { location.hash = ""; }
        } else { document.getElementById('admin-modal').style.display='none'; }
    };

    loadMarkers();

// –ö–∞—Ä—Ç–∞–Ω—ã ”ô—Ä 60 —Å–µ–∫—É–Ω–¥ —Å–∞–π—ã–Ω –∞–≤—Ç–æ–º–∞—Ç—Ç—ã —Ç“Ø—Ä–¥–µ –∂–∞“£–∞—Ä—Ç—ã–ø —Ç“±—Ä—É
setInterval(() => {
    console.log("–î–µ—Ä–µ–∫—Ç–µ—Ä –∞–≤—Ç–æ–º–∞—Ç—Ç—ã —Ç“Ø—Ä–¥–µ –∂–∞“£–∞—Ä—Ç—ã–ª—É–¥–∞...");
    loadMarkers(); 
}, 60000); // 60000 –º—Å = 1 –º–∏–Ω—É—Ç
    
</script>
</body>
</html>
